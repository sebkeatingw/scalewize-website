(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[956],{646:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},1007:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},1154:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},1469:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{default:function(){return d},getImageProps:function(){return n}});let s=a(8466),i=a(1264),l=a(3063),r=s._(a(1193));function n(e){let{props:t}=(0,i.getImgProps)(e,{defaultLoader:r.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,a]of Object.entries(t))void 0===a&&delete t[e];return{props:t}}let d=l.Image},2138:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},2310:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>j});var s=a(5155),i=a(2115),l=a(5695),r=a(2409),n=a(1154),d=a(9946);let o=(0,d.A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var c=a(2138),m=a(646);let u=(0,d.A)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var x=a(5525),h=a(3227),g=a(8883),f=a(1007),b=a(6766),p=a(6874),y=a.n(p);function j(e){let{params:t}=e,[a,d]=(0,i.useState)(!0),[p,j]=(0,i.useState)(null),[v,N]=(0,i.useState)(null),[w,k]=(0,i.useState)(!1),[A,z]=(0,i.useState)(!1),[I,_]=(0,i.useState)(!1),[S,C]=(0,i.useState)(""),[M,F]=(0,i.useState)(""),[P,q]=(0,i.useState)(""),[E,J]=(0,i.useState)(null),[L,W]=(0,i.useState)(""),O=(0,l.useRouter)();(0,i.useEffect)(()=>{(async()=>{let e=await t;W(e.token),T(e.token)})()},[t]);let T=async e=>{try{console.log("Validating token:",e);let{data:t,error:a}=await r.N.from("invitations").select("id, organization_id, email, expires_at, status, token, invited_by").eq("token",e).eq("status","pending").single();if(console.log("Invitation query result:",{invitationData:t,invitationError:a}),a||!t){console.error("Invitation not found:",a),j("Invalid or expired invitation link"),d(!1);return}let{data:s}=await r.N.from("organizations").select("name").eq("id",t.organization_id).single(),{data:i}=await r.N.from("profiles").select("full_name").eq("id",t.invited_by).single();if(new Date(t.expires_at)<new Date){console.log("Invitation expired:",t.expires_at),j("This invitation has expired"),d(!1);return}let l={...t,organization:s||{name:"Unknown Organization"},invited_by:i||{full_name:"Unknown User"}};console.log("Invitation validated successfully:",l),N(l),q(t.email.split("@")[0]),d(!1)}catch(e){console.error("Token validation error:",e),j("Failed to validate invitation"),d(!1)}},V=async()=>{if(v){k(!0);try{let{data:{user:e}}=await r.N.auth.getUser();if(e){if(e.email!==v.email){j("This invitation is for a different email address. Please log out and sign in with the correct account."),k(!1);return}await U(e.id)}else _(!0),k(!1)}catch(e){console.error("Accept invitation error:",e),j("Failed to accept invitation"),k(!1)}}},Y=async e=>{if(e.preventDefault(),S!==M)return void J("Passwords do not match");if(S.length<6)return void J("Password must be at least 6 characters");k(!0),J(null);try{let{data:{user:e},error:t}=await r.N.auth.signUp({email:v.email,password:S,options:{data:{full_name:P}}});if(t||!e)throw t||Error("Failed to create user account");await U(e.id)}catch(e){console.error("Signup error:",e),J(e instanceof Error?e.message:"Failed to create account"),k(!1)}},U=async e=>{try{let{error:t}=await r.N.from("profiles").insert({id:e,email:v.email,full_name:P,organization_id:v.organization_id,role:"user",status:"active",onboarding_step:"completed",profile_completion_percentage:100});if(t)throw t;let{error:a}=await r.N.from("invitations").update({status:"accepted"}).eq("id",v.id);a&&console.error("Failed to update invitation status:",a),z(!0),k(!1),setTimeout(()=>{O.push("/dashboard")},2e3)}catch(e){console.error("Join organization error:",e),j("Failed to join organization"),k(!1)}};return a?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",style:{background:"linear-gradient(135deg, #f8f7f4 0%, #f0ede8 100%)"},children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)(b.default,{src:"/scalewize_logo.png",alt:"ScaleWize AI Logo",width:200,height:50,className:"mx-auto"})}),(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 max-w-md mx-auto",children:[(0,s.jsx)(n.A,{className:"h-8 w-8 animate-spin text-blue-600 mx-auto mb-4"}),(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Validating invitation..."}),(0,s.jsx)("p",{className:"text-gray-600",children:"Please wait while we verify your invitation link."})]})]})}):p?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",style:{background:"linear-gradient(135deg, #f8f7f4 0%, #f0ede8 100%)"},children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)(b.default,{src:"/scalewize_logo.png",alt:"ScaleWize AI Logo",width:200,height:50,className:"mx-auto"})}),(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 max-w-md mx-auto",children:[(0,s.jsx)("div",{className:"w-16 h-16 rounded-full bg-red-100 flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)(o,{className:"h-8 w-8 text-red-600"})}),(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Invalid Invitation"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:p}),(0,s.jsxs)(y(),{href:"/login",className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center font-medium",children:["Go to Login",(0,s.jsx)(c.A,{className:"ml-2 h-4 w-4"})]})]})]})}):A?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",style:{background:"linear-gradient(135deg, #f8f7f4 0%, #f0ede8 100%)"},children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)(b.default,{src:"/scalewize_logo.png",alt:"ScaleWize AI Logo",width:200,height:50,className:"mx-auto"})}),(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 max-w-md mx-auto",children:[(0,s.jsx)("div",{className:"w-16 h-16 rounded-full bg-green-100 flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)(m.A,{className:"h-8 w-8 text-green-600"})}),(0,s.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:["Welcome to ",null==v?void 0:v.organization.name,"!"]}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:"You've successfully joined the organization. Redirecting to dashboard..."}),(0,s.jsx)(n.A,{className:"h-6 w-6 animate-spin text-blue-600 mx-auto"})]})]})}):I?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",style:{background:"linear-gradient(135deg, #f8f7f4 0%, #f0ede8 100%)"},children:(0,s.jsxs)("div",{className:"text-center w-full max-w-md",children:[(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsx)(b.default,{src:"/scalewize_logo.png",alt:"ScaleWize AI Logo",width:200,height:50,className:"mx-auto"})}),(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8",children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("div",{className:"w-16 h-16 rounded-full bg-blue-100 flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)(u,{className:"h-8 w-8 text-blue-600"})}),(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Create Your Account"}),(0,s.jsxs)("p",{className:"text-gray-600",children:["Join ",null==v?void 0:v.organization.name," on ScaleWize AI"]})]}),(0,s.jsxs)("form",{onSubmit:Y,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2 text-left",children:"Email Address"}),(0,s.jsx)("input",{type:"email",id:"email",value:null==v?void 0:v.email,disabled:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg bg-gray-50 text-gray-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"fullName",className:"block text-sm font-medium text-gray-700 mb-2 text-left",children:"Full Name"}),(0,s.jsx)("input",{type:"text",id:"fullName",value:P,onChange:e=>q(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2 text-left",children:"Password"}),(0,s.jsx)("input",{type:"password",id:"password",value:S,onChange:e=>C(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,minLength:6})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2 text-left",children:"Confirm Password"}),(0,s.jsx)("input",{type:"password",id:"confirmPassword",value:M,onChange:e=>F(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,minLength:6})]}),E&&(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:E}),(0,s.jsx)("button",{type:"submit",disabled:w,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center font-medium",children:w?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.A,{className:"h-4 w-4 animate-spin mr-2"}),"Creating Account..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Create Account & Join Organization"]})})]}),(0,s.jsx)("div",{className:"mt-6 text-center",children:(0,s.jsx)(y(),{href:"/login",className:"text-sm text-blue-600 hover:text-blue-700",children:"Already have an account? Sign in"})})]})]})}):(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",style:{background:"linear-gradient(135deg, #f8f7f4 0%, #f0ede8 100%)"},children:(0,s.jsxs)("div",{className:"text-center w-full max-w-md",children:[(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsx)(b.default,{src:"/scalewize_logo.png",alt:"ScaleWize AI Logo",width:200,height:50,className:"mx-auto"})}),(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8",children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("div",{className:"w-16 h-16 rounded-full bg-blue-100 flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)(h.A,{className:"h-8 w-8 text-blue-600"})}),(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"You're Invited!"}),(0,s.jsxs)("p",{className:"text-gray-600",children:["Join ",null==v?void 0:v.organization.name," on ScaleWize AI"]})]}),(0,s.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center",children:(0,s.jsx)(g.A,{className:"h-5 w-5 text-blue-600"})}),(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:null==v?void 0:v.email}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Invited email address"})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-lg bg-green-100 flex items-center justify-center",children:(0,s.jsx)(f.A,{className:"h-5 w-5 text-green-600"})}),(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:null==v?void 0:v.invited_by.full_name}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Invited by"})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-lg bg-purple-100 flex items-center justify-center",children:(0,s.jsx)(h.A,{className:"h-5 w-5 text-purple-600"})}),(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:null==v?void 0:v.organization.name}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Organization"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("button",{onClick:V,disabled:w,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center font-medium",children:w?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.A,{className:"h-4 w-4 animate-spin mr-2"}),"Processing..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Accept Invitation"]})}),(0,s.jsx)(y(),{href:"/login",className:"w-full bg-gray-100 text-gray-700 py-3 px-4 rounded-lg hover:bg-gray-200 transition-colors flex items-center justify-center font-medium",children:"I already have an account"})]}),(0,s.jsx)("div",{className:"mt-6 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,s.jsxs)("p",{className:"text-xs text-yellow-800",children:[(0,s.jsx)("strong",{children:"Note:"})," This invitation expires on ",new Date((null==v?void 0:v.expires_at)||"").toLocaleDateString()]})})]}),(0,s.jsx)("div",{className:"mt-8 text-center",children:(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Powered by ScaleWize AI - Simplifying AI for businesses"})})]})})}},2409:(e,t,a)=>{"use strict";a.d(t,{N:()=>s});let s=(0,a(2121).createBrowserClient)("https://mtybaactacapokejmtxy.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im10eWJhYWN0YWNhcG9rZWptdHh5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE3MTE5MTMsImV4cCI6MjA2NzI4NzkxM30.u9EudibnPY-rGAFX4E2TfCgyKEBa9_7a2nojUcICJGQ")},3227:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("building-2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]])},3911:(e,t,a)=>{Promise.resolve().then(a.bind(a,2310))},5525:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},6766:(e,t,a)=>{"use strict";a.d(t,{default:()=>i.a});var s=a(1469),i=a.n(s)},8883:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[864,874,63,441,684,358],()=>t(3911)),_N_E=e.O()}]);